INSERT INTO SOURCE_FIXTURES (
    fixture_id,
    code,
    event,
    finished,
    finished_provisional,
    kickoff_time,
    minutes,
    provisional_start_time,
    started,
    team_a,
    team_a_score,
    team_h,
    team_h_score,
    stats,
    team_h_difficulty,
    team_a_difficulty,
    pulse_id,
    extraction_timestamp,
    extraction_date
)
SELECT 
    fixture.value:id::INTEGER as fixture_id,
    fixture.value:code::INTEGER as code,
    fixture.value:event::INTEGER as event,
    fixture.value:finished::BOOLEAN as finished,
    fixture.value:finished_provisional::BOOLEAN as finished_provisional,
    fixture.value:kickoff_time::TIMESTAMP_NTZ as kickoff_time,
    fixture.value:minutes::INTEGER as minutes,
    fixture.value:provisional_start_time::BOOLEAN as provisional_start_time,
    fixture.value:started::BOOLEAN as started,
    fixture.value:team_a::INTEGER as team_a,
    fixture.value:team_a_score::INTEGER as team_a_score,
    fixture.value:team_h::INTEGER as team_h,
    fixture.value:team_h_score::INTEGER as team_h_score,
    fixture.value:stats as stats,
    fixture.value:team_h_difficulty::INTEGER as team_h_difficulty,
    fixture.value:team_a_difficulty::INTEGER as team_a_difficulty,
    fixture.value:pulse_id::INTEGER as pulse_id,
    extraction_timestamp,
    extraction_date
FROM STAGING_FIXTURES,
LATERAL FLATTEN(input => raw_data:fixtures) as fixture;